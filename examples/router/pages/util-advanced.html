<div class="cui-fluid">
  <!-- í˜ì´ì§€ í—¤ë” -->
  <div class="cui-page-header cui-mb-15">
    <div class="cui-page-title-wrap">
      <h2 class="cui-page-title">ìœ í‹¸ë¦¬í‹° - ê³ ê¸‰</h2>
      <button type="button" class="cui-page-refresh" onclick="router.refresh()"><i class="cui-icon">refresh</i></button>
    </div>
    <div class="cui-breadcrumb">
      <a href="javascript:;">í™ˆ</a>
      <a href="javascript:;">ì»´í¬ë„ŒíŠ¸</a>
      <span>ìœ í‹¸ë¦¬í‹° ê³ ê¸‰</span>
    </div>
  </div>

  <!-- ì¹´ìš´íŠ¸ë‹¤ìš´ -->
  <div class="cui-card cui-mb-15">
    <div class="cui-card-header cui-flex cui-flex-between cui-flex-middle">
      <span>ì¹´ìš´íŠ¸ë‹¤ìš´</span>
      <code class="cui-text-secondary">util.countdown(endTime, callback)</code>
    </div>
    <div class="cui-card-body">
      <p class="cui-text-secondary cui-mb-10">íŠ¹ì • ì‹œê°„ê¹Œì§€ ë‚¨ì€ ì‹œê°„ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤.</p>
      <div class="cui-flex cui-gap-10 cui-mb-15">
        <button id="btnCountdown1" class="cui-btn cui-btn-primary">1ë¶„ ì¹´ìš´íŠ¸ë‹¤ìš´</button>
        <button id="btnCountdown5" class="cui-btn">5ë¶„ ì¹´ìš´íŠ¸ë‹¤ìš´</button>
      </div>
      <div id="countdownDisplay" class="cui-flex cui-gap-10 cui-flex-center" style="font-size:32px;font-weight:700;">
        <div class="cui-text-center"><span id="cdDays">00</span><div class="cui-text-xs cui-text-secondary">ì¼</div></div>
        <span>:</span>
        <div class="cui-text-center"><span id="cdHours">00</span><div class="cui-text-xs cui-text-secondary">ì‹œ</div></div>
        <span>:</span>
        <div class="cui-text-center"><span id="cdMinutes">00</span><div class="cui-text-xs cui-text-secondary">ë¶„</div></div>
        <span>:</span>
        <div class="cui-text-center"><span id="cdSeconds">00</span><div class="cui-text-xs cui-text-secondary">ì´ˆ</div></div>
      </div>
    </div>
  </div>

  <!-- ì¹´ìš´íŠ¸ì—… ì• ë‹ˆë©”ì´ì…˜ -->
  <div class="cui-card cui-mb-15">
    <div class="cui-card-header cui-flex cui-flex-between cui-flex-middle">
      <span>ìˆ«ì ì¹´ìš´íŠ¸ì—…</span>
      <code class="cui-text-secondary">util.countUp(options)</code>
    </div>
    <div class="cui-card-body">
      <p class="cui-text-secondary cui-mb-10">ìˆ«ìê°€ ì• ë‹ˆë©”ì´ì…˜ê³¼ í•¨ê»˜ ì¦ê°€í•©ë‹ˆë‹¤.</p>
      <div class="cui-flex cui-gap-20 cui-mb-15">
        <div class="cui-text-center">
          <div id="countUp1" style="font-size:36px;font-weight:700;color:var(--cui-primary);">0</div>
          <div class="cui-text-secondary">ë°©ë¬¸ì</div>
        </div>
        <div class="cui-text-center">
          <div id="countUp2" style="font-size:36px;font-weight:700;color:var(--cui-success);">0</div>
          <div class="cui-text-secondary">ë§¤ì¶œ</div>
        </div>
        <div class="cui-text-center">
          <div id="countUp3" style="font-size:36px;font-weight:700;color:var(--cui-warning);">0%</div>
          <div class="cui-text-secondary">ì„±ì¥ë¥ </div>
        </div>
      </div>
      <button id="btnCountUp" class="cui-btn cui-btn-primary">ì¹´ìš´íŠ¸ì—… ì‹œì‘</button>
    </div>
  </div>

  <!-- ë””ë°”ìš´ìŠ¤ / ì“°ë¡œí‹€ -->
  <div class="cui-card cui-mb-15">
    <div class="cui-card-header cui-flex cui-flex-between cui-flex-middle">
      <span>ë””ë°”ìš´ìŠ¤ / ì“°ë¡œí‹€</span>
      <code class="cui-text-secondary">util.debounce() / util.throttle()</code>
    </div>
    <div class="cui-card-body">
      <p class="cui-text-secondary cui-mb-10">ì—°ì†ì ì¸ ì´ë²¤íŠ¸ í˜¸ì¶œì„ ì œì–´í•©ë‹ˆë‹¤.</p>
      <div class="cui-mb-15">
        <label class="cui-text-sm cui-block cui-mb-5">ì…ë ¥ í…ŒìŠ¤íŠ¸ (ê°ê° ë””ë°”ìš´ìŠ¤/ì“°ë¡œí‹€ ì ìš©)</label>
        <input type="text" id="debounceInput" class="cui-input" placeholder="ë””ë°”ìš´ìŠ¤ ì…ë ¥ (300ms)" style="width:100%;">
      </div>
      <div class="cui-flex cui-gap-10 cui-mb-10">
        <button id="throttleBtn" class="cui-btn cui-btn-primary" style="flex:1;">ì“°ë¡œí‹€ ë²„íŠ¼ (ì—°íƒ€í•´ë³´ì„¸ìš”)</button>
      </div>
      <div id="debounceLogs" style="height:120px;overflow:auto;background:#f5f5f5;padding:10px;border-radius:4px;font-size:12px;font-family:monospace;"></div>
    </div>
  </div>

  <!-- XSS ë°©ì§€ -->
  <div class="cui-card cui-mb-15">
    <div class="cui-card-header cui-flex cui-flex-between cui-flex-middle">
      <span>XSS ë°©ì§€</span>
      <code class="cui-text-secondary">util.escape() / util.sanitize() / util.stripScripts()</code>
    </div>
    <div class="cui-card-body">
      <p class="cui-text-secondary cui-mb-10">ì‚¬ìš©ì ì…ë ¥ì—ì„œ ìœ„í—˜í•œ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì œê±°í•©ë‹ˆë‹¤.</p>
      <div class="cui-mb-10">
        <label class="cui-text-sm cui-block cui-mb-5">ìœ„í—˜í•œ HTML ì…ë ¥</label>
        <textarea id="xssInput" class="cui-textarea" rows="3" style="width:100%;">&lt;script&gt;alert('XSS!')&lt;/script&gt;&lt;p onclick="evil()"&gt;í´ë¦­&lt;/p&gt;&lt;a href="javascript:alert(1)"&gt;ë§í¬&lt;/a&gt;</textarea>
      </div>
      <div class="cui-flex cui-gap-10 cui-mb-10">
        <button id="btnEscape" class="cui-btn">escape</button>
        <button id="btnStripScripts" class="cui-btn">stripScripts</button>
        <button id="btnSanitize" class="cui-btn cui-btn-primary">sanitize</button>
      </div>
      <pre id="xssResult" style="background:#f5f5f5;padding:10px;border-radius:4px;font-size:12px;white-space:pre-wrap;word-break:break-all;"></pre>
    </div>
  </div>

  <!-- ì¿ í‚¤ ê´€ë¦¬ -->
  <div class="cui-card cui-mb-15">
    <div class="cui-card-header cui-flex cui-flex-between cui-flex-middle">
      <span>ì¿ í‚¤ ê´€ë¦¬</span>
      <code class="cui-text-secondary">setCookie / getCookie / removeCookie</code>
    </div>
    <div class="cui-card-body">
      <div class="cui-form-inline cui-mb-10">
        <div class="cui-form-item">
          <label class="cui-form-label">í‚¤</label>
          <div class="cui-form-input">
            <input type="text" id="cookieKey" class="cui-input" value="testCookie" style="width:120px;">
          </div>
        </div>
        <div class="cui-form-item" style="flex:1;">
          <label class="cui-form-label">ê°’</label>
          <div class="cui-form-input" style="display:flex;gap:10px;">
            <input type="text" id="cookieValue" class="cui-input" value="Hello World!" style="flex:1;">
          </div>
        </div>
      </div>
      <div class="cui-flex cui-gap-10 cui-mb-10">
        <button id="btnSetCookie" class="cui-btn cui-btn-primary">ì €ì¥ (7ì¼)</button>
        <button id="btnGetCookie" class="cui-btn">ì½ê¸°</button>
        <button id="btnRemoveCookie" class="cui-btn cui-btn-danger">ì‚­ì œ</button>
      </div>
      <div id="cookieResult" class="cui-text-secondary"></div>
    </div>
  </div>

  <!-- ë”¥ ë³µì‚¬ -->
  <div class="cui-card cui-mb-15">
    <div class="cui-card-header cui-flex cui-flex-between cui-flex-middle">
      <span>ë”¥ ë³µì‚¬</span>
      <code class="cui-text-secondary">util.deepClone(obj)</code>
    </div>
    <div class="cui-card-body">
      <p class="cui-text-secondary cui-mb-10">ì¤‘ì²©ëœ ê°ì²´ë¥¼ ì™„ì „íˆ ë³µì‚¬í•©ë‹ˆë‹¤. ì›ë³¸ ìˆ˜ì •ì´ ë³µì‚¬ë³¸ì— ì˜í–¥ì„ ì£¼ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
      <button id="btnDeepClone" class="cui-btn cui-btn-primary">ë”¥ ë³µì‚¬ í…ŒìŠ¤íŠ¸</button>
      <pre id="deepCloneResult" class="cui-mt-10" style="background:#f5f5f5;padding:10px;border-radius:4px;font-size:12px;"></pre>
    </div>
  </div>

  <!-- ìŠ¤í¬ë¡¤ ì• ë‹ˆë©”ì´ì…˜ -->
  <div class="cui-card">
    <div class="cui-card-header cui-flex cui-flex-between cui-flex-middle">
      <span>ìŠ¤í¬ë¡¤ ì• ë‹ˆë©”ì´ì…˜</span>
      <code class="cui-text-secondary">util.scrollTo(position, duration)</code>
    </div>
    <div class="cui-card-body">
      <p class="cui-text-secondary cui-mb-10">ë¶€ë“œëŸ¬ìš´ ìŠ¤í¬ë¡¤ ì• ë‹ˆë©”ì´ì…˜ìœ¼ë¡œ íŠ¹ì • ìœ„ì¹˜ë¡œ ì´ë™í•©ë‹ˆë‹¤.</p>
      <div class="cui-flex cui-gap-10">
        <button id="btnScrollTop" class="cui-btn">ë§¨ ìœ„ë¡œ</button>
        <button id="btnScrollBottom" class="cui-btn">ë§¨ ì•„ë˜ë¡œ</button>
        <button id="btnScroll500" class="cui-btn cui-btn-primary">500px ìœ„ì¹˜ë¡œ</button>
      </div>
    </div>
  </div>
</div>

<script>
Catui.use(['util', 'popup'], function(){
  
  var countdownTimer = null;
  
  // ì¹´ìš´íŠ¸ë‹¤ìš´ (router.addIntervalë¡œ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€)
  function startCountdown(minutes){
    if(countdownTimer) clearInterval(countdownTimer);
    
    var endTime = Date.now() + minutes * 60 * 1000;
    countdownTimer = util.countdown(endTime, function(d, h, m, s, status){
      document.getElementById('cdDays').textContent = util.digit(d);
      document.getElementById('cdHours').textContent = util.digit(h);
      document.getElementById('cdMinutes').textContent = util.digit(m);
      document.getElementById('cdSeconds').textContent = util.digit(s);
      
      if(status === 'end'){
        popup.msg('ì¹´ìš´íŠ¸ë‹¤ìš´ ì¢…ë£Œ!');
      }
    });
    
    // í˜ì´ì§€ ì´ë™ ì‹œ ìë™ ì •ë¦¬
    if(window.router){
      router.addCleanup(function(){
        if(countdownTimer) clearInterval(countdownTimer);
      });
    }
  }
  
  // ì´ë²¤íŠ¸ ë°”ì¸ë”© (router.bindEventë¡œ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€)
  var bindEvent = window.router ? router.bindEvent.bind(router) : function(el, type, fn){
    document.getElementById(el.replace('#','')).addEventListener(type, fn);
  };
  
  bindEvent('#btnCountdown1', 'click', function(){
    startCountdown(1);
    popup.msg('1ë¶„ ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œì‘');
  });
  
  bindEvent('#btnCountdown5', 'click', function(){
    startCountdown(5);
    popup.msg('5ë¶„ ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œì‘');
  });

  // ì¹´ìš´íŠ¸ì—…
  bindEvent('#btnCountUp', 'click', function(){
    util.countUp({
      elem: '#countUp1',
      start: 0,
      end: 12847,
      duration: 2000,
      separator: ','
    });
    
    util.countUp({
      elem: '#countUp2',
      start: 0,
      end: 8456200,
      duration: 2000,
      separator: ',',
      prefix: 'â‚©'
    });
    
    util.countUp({
      elem: '#countUp3',
      start: 0,
      end: 23.5,
      duration: 2000,
      decimals: 1,
      suffix: '%'
    });
  });

  // ë””ë°”ìš´ìŠ¤
  var logEl = document.getElementById('debounceLogs');
  function log(msg){
    var time = new Date().toLocaleTimeString();
    logEl.innerHTML = '<div>[' + time + '] ' + msg + '</div>' + logEl.innerHTML;
  }
  
  var debouncedHandler = util.debounce(function(val){
    log('ğŸ”µ Debounced: "' + val + '"');
  }, 300);
  
  bindEvent('#debounceInput', 'input', function(e){
    log('âšª Input: "' + e.target.value + '"');
    debouncedHandler(e.target.value);
  });

  // ì“°ë¡œí‹€
  var throttleCount = 0;
  var throttledHandler = util.throttle(function(){
    throttleCount++;
    log('ğŸŸ¢ Throttled ì‹¤í–‰ #' + throttleCount);
  }, 500);
  
  bindEvent('#throttleBtn', 'click', function(){
    log('âšª ë²„íŠ¼ í´ë¦­');
    throttledHandler();
  });

  // XSS ë°©ì§€
  bindEvent('#btnEscape', 'click', function(){
    var input = document.getElementById('xssInput').value;
    document.getElementById('xssResult').textContent = 'util.escape() ê²°ê³¼:\n\n' + util.escape(input);
  });
  
  bindEvent('#btnStripScripts', 'click', function(){
    var input = document.getElementById('xssInput').value;
    document.getElementById('xssResult').textContent = 'util.stripScripts() ê²°ê³¼:\n\n' + util.stripScripts(input);
  });
  
  bindEvent('#btnSanitize', 'click', function(){
    var input = document.getElementById('xssInput').value;
    document.getElementById('xssResult').textContent = 'util.sanitize() ê²°ê³¼:\n\n' + util.sanitize(input);
  });

  // ì¿ í‚¤ ê´€ë¦¬
  bindEvent('#btnSetCookie', 'click', function(){
    var key = document.getElementById('cookieKey').value;
    var val = document.getElementById('cookieValue').value;
    util.setCookie(key, val, 7);
    document.getElementById('cookieResult').innerHTML = 'âœ… ì¿ í‚¤ ì €ì¥ë¨: <strong>' + key + ' = ' + val + '</strong> (7ì¼)';
  });
  
  bindEvent('#btnGetCookie', 'click', function(){
    var key = document.getElementById('cookieKey').value;
    var val = util.getCookie(key);
    document.getElementById('cookieResult').innerHTML = val 
      ? 'ğŸ“– ì¿ í‚¤ ì½ê¸°: <strong>' + key + ' = ' + val + '</strong>'
      : 'âš ï¸ ì¿ í‚¤ ì—†ìŒ: ' + key;
  });
  
  bindEvent('#btnRemoveCookie', 'click', function(){
    var key = document.getElementById('cookieKey').value;
    util.removeCookie(key);
    document.getElementById('cookieResult').innerHTML = 'ğŸ—‘ï¸ ì¿ í‚¤ ì‚­ì œë¨: <strong>' + key + '</strong>';
  });

  // ë”¥ ë³µì‚¬
  bindEvent('#btnDeepClone', 'click', function(){
    var original = {
      name: 'í™ê¸¸ë™',
      info: {
        age: 30,
        address: { city: 'ì„œìš¸', zip: '12345' }
      },
      tags: ['ê°œë°œì', 'JS']
    };
    
    var clone = util.deepClone(original);
    
    // ì›ë³¸ ìˆ˜ì •
    original.info.age = 99;
    original.info.address.city = 'ë¶€ì‚°';
    original.tags.push('ìˆ˜ì •ë¨');
    
    var result = 'ì›ë³¸ (ìˆ˜ì • í›„):\n' + JSON.stringify(original, null, 2) + 
                 '\n\në³µì‚¬ë³¸ (ì˜í–¥ ì—†ìŒ):\n' + JSON.stringify(clone, null, 2);
    document.getElementById('deepCloneResult').textContent = result;
  });

  // ìŠ¤í¬ë¡¤ ì• ë‹ˆë©”ì´ì…˜
  bindEvent('#btnScrollTop', 'click', function(){
    util.scrollTo(0, 500);
  });
  
  bindEvent('#btnScrollBottom', 'click', function(){
    var docHeight = Math.max(
      document.body.scrollHeight,
      document.documentElement.scrollHeight
    );
    util.scrollTo(docHeight, 500);
  });
  
  bindEvent('#btnScroll500', 'click', function(){
    util.scrollTo(500, 500);
  });
});
</script>
</div>
